<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Ññ7. –û—Ç—á–µ—Ç –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é In-Memory –°–£–ë–î –¥–ª—è –º–æ–¥—É–ª—è –¥–∏–∞–ª–æ–≥–æ–≤</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        h1 {
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            margin-top: 30px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
        }
        pre {
            background-color: #f8f8f8;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            overflow-x: auto;
        }
        code {
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
            background-color: #f8f8f8;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .highlight {
            background-color: #ffffcc;
            padding: 2px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .note {
            background-color: #e7f3fe;
            border-left: 6px solid #2196F3;
            padding: 10px;
            margin: 15px 0;
        }
        .warning {
            background-color: #fff3cd;
            border-left: 6px solid #ffc107;
            padding: 10px;
            margin: 15px 0;
        }
        .success {
            background-color: #d4edda;
            border-left: 6px solid #28a745;
            padding: 10px;
            margin: 15px 0;
        }
        img {
            max-width: 100%;
            height: auto;
        }
        .architecture-diagram {
            text-align: center;
            margin: 20px 0;
            font-family: monospace;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
        }
        .comparison-table {
            margin: 20px 0;
        }
        .improvement {
            font-weight: bold;
        }
        .improvement.positive {
            color: #28a745;
        }
        .improvement.negative {
            color: #dc3545;
        }
    </style>
</head>
<body>
    <h1>OTUS. Highload Architecture</h1>
    <h2>–î–ó ‚Ññ 7 - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ In-Memory –°–£–ë–î –¥–ª—è –º–æ–¥—É–ª—è –¥–∏–∞–ª–æ–≥–æ–≤</h2>
    <h3>–ê–≤–¥–æ–Ω–∏–Ω –î–º–∏—Ç—Ä–∏–π</h3>

    <h2>–ó–∞–¥–∞—á–∞</h2>
    <p>–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥—É–ª—è –¥–∏–∞–ª–æ–≥–æ–≤ –∏–∑ PostgreSQL –≤ In-Memory –°–£–ë–î (Redis) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º UDF (User Defined Functions) –∏ –ø—Ä–æ–≤–µ—Å—Ç–∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:</p>
    <ul>
        <li>–í—ã–±—Ä–∞—Ç—å –º–æ–¥—É–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ (–¥–∏–∞–ª–æ–≥–∏)</li>
        <li>–ü—Ä–æ–≤–µ—Å—Ç–∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å PostgreSQL</li>
        <li>–í—ã–Ω–µ—Å—Ç–∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Redis —Å UDF</li>
        <li>–ü—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</li>
        <li>–°—Ä–∞–≤–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</li>
    </ul>

    <h2>–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è</h2>
    
    <div class="architecture-diagram">
        <pre>
                    –ò–°–•–û–î–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê (PostgreSQL)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Test Client   ‚îÇ    ‚îÇ  FastAPI App     ‚îÇ    ‚îÇ   PostgreSQL    ‚îÇ
‚îÇ   (aiohttp)     ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ  (Dialogs API)   ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   (Citus)       ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                  ‚îÇ    ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

                    –ù–û–í–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê (Redis UDF)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Test Client   ‚îÇ    ‚îÇ  FastAPI App     ‚îÇ    ‚îÇ     Redis       ‚îÇ
‚îÇ   (aiohttp)     ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ  (Dialogs API)   ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   + UDF Lua     ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                  ‚îÇ    ‚îÇ   Functions     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        </pre>
    </div>

    <h3>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã</h3>
    <ul>
        <li><strong>FastAPI Application</strong> - –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å API –¥–∏–∞–ª–æ–≥–æ–≤</li>
        <li><strong>PostgreSQL (Citus)</strong> - –∏—Å—Ö–æ–¥–Ω–∞—è —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –°–£–ë–î</li>
        <li><strong>Redis + UDF</strong> - In-Memory –°–£–ë–î —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏</li>
        <li><strong>Test Scripts</strong> - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</li>
        <li><strong>Performance Analyzer</strong> - —Å–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ –º–µ—Ç—Ä–∏–∫</li>
    </ul>

    <h2>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –≤ Redis UDF</h2>
    
    <h3>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Redis</h3>
    <p>–î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∏–∞–ª–æ–≥–æ–≤ –≤ Redis –±—ã–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:</p>
    
    <pre><code># –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª—é—á–µ–π Redis –¥–ª—è –¥–∏–∞–ª–æ–≥–æ–≤:
dialog:{dialog_id}:messages     # –°–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–∏–∞–ª–æ–≥–∞
dialog:{dialog_id}:participants # –£—á–∞—Å—Ç–Ω–∏–∫–∏ –¥–∏–∞–ª–æ–≥–∞
user:{user_id}:dialogs         # –°–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
message:{message_id}           # –î–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</code></pre>

    <h3>UDF —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è Redis</h3>
    <p>–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ Lua-—Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π —Å –¥–∏–∞–ª–æ–≥–∞–º–∏:</p>
    
    <pre><code>-- –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –¥–∏–∞–ª–æ–≥
local function send_message_to_dialog(dialog_id, message_data)
    -- –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–∞
    redis.call('LPUSH', 'dialog:' .. dialog_id .. ':messages', message_data)
    
    -- –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
    redis.call('HSET', 'dialog:' .. dialog_id, 'last_message_time', 
               redis.call('TIME')[1])
    
    -- –£–≤–µ–¥–æ–º–ª—è–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
    local participants = redis.call('SMEMBERS', 
                                   'dialog:' .. dialog_id .. ':participants')
    for i, user_id in ipairs(participants) do
        redis.call('SADD', 'user:' .. user_id .. ':unread_dialogs', dialog_id)
    end
    
    return 'OK'
end

-- –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –¥–∏–∞–ª–æ–≥–∞
local function get_dialog_messages(dialog_id, limit, offset)
    local messages = redis.call('LRANGE', 
                               'dialog:' .. dialog_id .. ':messages', 
                               offset or 0, 
                               (offset or 0) + (limit or 50) - 1)
    return messages
end</code></pre>

    <h2>–ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
    
    <h3>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
    <div class="note">
        <p><strong>–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤:</strong></p>
        <ul>
            <li>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 40</li>
            <li>–°–æ–æ–±—â–µ–Ω–∏–π –≤ –¥–∏–∞–ª–æ–≥–µ: 20</li>
            <li>–î–∏–∞–ª–æ–≥–æ–≤ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: 10</li>
            <li>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π: 8,000</li>
            <li>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è: 400</li>
        </ul>
    </div>

    <h3>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
    <p>–°–æ–∑–¥–∞–Ω—ã —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</p>
    
    <pre><code># test_dialogs_postgres.sh - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ PostgreSQL
#!/bin/bash
echo "üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ PostgreSQL..."

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞
curl -f http://localhost:9000/health || exit 1

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
source venv/bin/activate
pip install aiohttp

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
python3 -c "
import asyncio
from performance_test_dialogs import run_performance_test

asyncio.run(run_performance_test(
    users=40,
    messages_per_dialog=20,
    dialogs_per_user=10,
    backend='postgresql',
    output_file='lesson-07/dialog_metrics_postgresql.json'
))
"</code></pre>

    <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
    
    <div class="success">
        <p><strong>–†–ï–ó–£–õ–¨–¢–ê–¢ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:</strong> –ü—Ä–æ–≤–µ–¥–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ PostgreSQL –∏ Redis UDF –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –¥–∏–∞–ª–æ–≥–∞–º–∏.</p>
    </div>

    <h3>–°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h3>
    <table class="comparison-table">
        <thead>
            <tr>
                <th>–û–ø–µ—Ä–∞—Ü–∏—è</th>
                <th>PostgreSQL (—Å–µ–∫)</th>
                <th>Redis UDF (—Å–µ–∫)</th>
                <th>–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</th>
                <th>–£–ª—É—á—à–µ–Ω–∏–µ</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π</td>
                <td>21.588</td>
                <td>19.466</td>
                <td>Redis UDF</td>
                <td><span class="improvement positive">+9.8%</span></td>
            </tr>
            <tr>
                <td>–ß—Ç–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π</td>
                <td>1.910</td>
                <td>1.684</td>
                <td>Redis UDF</td>
                <td><span class="improvement positive">+11.8%</span></td>
            </tr>
        </tbody>
    </table>

    <h3>–î–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
    
    <h4>–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π</h4>
    <table>
        <tr>
            <th>–ú–µ—Ç—Ä–∏–∫–∞</th>
            <th>PostgreSQL</th>
            <th>Redis UDF</th>
        </tr>
        <tr>
            <td>–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</td>
            <td>21.588 —Å–µ–∫</td>
            <td>19.466 —Å–µ–∫</td>
        </tr>
        <tr>
            <td>–û–ø–µ—Ä–∞—Ü–∏–π –≤ —Å–µ–∫—É–Ω–¥—É</td>
            <td>0.0</td>
            <td>0.1</td>
        </tr>
        <tr>
            <td>–ú–µ–¥–∏–∞–Ω–∞</td>
            <td>21.588 —Å–µ–∫</td>
            <td>19.466 —Å–µ–∫</td>
        </tr>
        <tr>
            <td>95-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å</td>
            <td>21.588 —Å–µ–∫</td>
            <td>19.466 —Å–µ–∫</td>
        </tr>
    </table>

    <h4>–ß—Ç–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π</h4>
    <table>
        <tr>
            <th>–ú–µ—Ç—Ä–∏–∫–∞</th>
            <th>PostgreSQL</th>
            <th>Redis UDF</th>
        </tr>
        <tr>
            <td>–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</td>
            <td>1.910 —Å–µ–∫</td>
            <td>1.684 —Å–µ–∫</td>
        </tr>
        <tr>
            <td>–û–ø–µ—Ä–∞—Ü–∏–π –≤ —Å–µ–∫—É–Ω–¥—É</td>
            <td>0.5</td>
            <td>0.6</td>
        </tr>
        <tr>
            <td>–ú–µ–¥–∏–∞–Ω–∞</td>
            <td>1.910 —Å–µ–∫</td>
            <td>1.684 —Å–µ–∫</td>
        </tr>
        <tr>
            <td>95-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å</td>
            <td>1.910 —Å–µ–∫</td>
            <td>1.684 —Å–µ–∫</td>
        </tr>
    </table>

    <h2>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è</h2>
    
    <h3>–°–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</h3>
    <ul>
        <li><code>test_dialogs_postgres.sh</code> - —Å–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è PostgreSQL</li>
        <li><code>test_dialogs_redis.sh</code> - —Å–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Redis UDF</li>
        <li><code>dialog_comparison_report.py</code> - –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä HTML –æ—Ç—á–µ—Ç–æ–≤</li>
        <li><code>performance_test_dialogs.py</code> - –º–æ–¥—É–ª—å –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</li>
        <li><code>lesson-07/README.md</code> - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é</li>
    </ul>

    <h3>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
    <pre><code># –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
./stop_service.sh                              # –û—á–∏—Å—Ç–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
./start_service.sh --backend postgresql       # –ó–∞–ø—É—Å–∫ PostgreSQL
./test_dialogs_postgres.sh                    # –¢–µ—Å—Ç PostgreSQL

./stop_service.sh                              # –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ
./start_service.sh --backend redis            # –ó–∞–ø—É—Å–∫ Redis UDF  
./test_dialogs_redis.sh                       # –¢–µ—Å—Ç Redis UDF

python3 dialog_comparison_report.py           # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞</code></pre>

    <h2>–í—ã–≤–æ–¥—ã –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
    
    <div class="success">
        <h3>‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</h3>
        <ul>
            <li><strong>–ú–æ–¥—É–ª—å –¥–∏–∞–ª–æ–≥–æ–≤ –≤—ã–Ω–µ—Å–µ–Ω –≤ In-Memory –°–£–ë–î (Redis)</strong></li>
            <li><strong>–õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤ UDF (Lua-—Ñ—É–Ω–∫—Ü–∏–∏ Redis)</strong></li>
            <li><strong>–ü—Ä–æ–≤–µ–¥–µ–Ω–æ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –î–û –∏ –ü–û–°–õ–ï</strong></li>
            <li><strong>–ü–æ–ª—É—á–µ–Ω–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</strong></li>
        </ul>
    </div>

    <h3>–û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h3>
    <ul>
        <li><strong>–£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:</strong> Redis UDF –ø–æ–∫–∞–∑–∞–ª –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –≤—Å–µ–º –æ–ø–µ—Ä–∞—Ü–∏—è–º</li>
        <li><strong>–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π:</strong> —É–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ 9.8% (—Å 21.588—Å –¥–æ 19.466—Å)</li>
        <li><strong>–ß—Ç–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π:</strong> —É–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ 11.8% (—Å 1.910—Å –¥–æ 1.684—Å)</li>
    </ul>

    <h2>–§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞</h2>
    <pre><code>lesson-07/
‚îú‚îÄ‚îÄ dialog_metrics_postgresql.json     # –ú–µ—Ç—Ä–∏–∫–∏ PostgreSQL
‚îú‚îÄ‚îÄ dialog_metrics_redis_udf.json      # –ú–µ—Ç—Ä–∏–∫–∏ Redis UDF
‚îú‚îÄ‚îÄ dialog_performance_comparison.html # –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
‚îú‚îÄ‚îÄ homework_report.html               # –î–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç
‚îî‚îÄ‚îÄ README.md                          # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é

–ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:
‚îú‚îÄ‚îÄ test_dialogs_postgres.sh           # –°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è PostgreSQL
‚îú‚îÄ‚îÄ test_dialogs_redis.sh              # –°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Redis UDF
‚îú‚îÄ‚îÄ dialog_comparison_report.py        # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á–µ—Ç–æ–≤
‚îî‚îÄ‚îÄ performance_test_dialogs.py        # –ú–æ–¥—É–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</code></pre>
</body>
</html> 